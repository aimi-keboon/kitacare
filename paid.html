<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Successful | kitacare</title>
    <link rel="stylesheet" href="style.css">
    <style>
        :root { --brand-blue: #007bff; --brand-black: #000000; --bg-light: #f8f9fa; }
        
        body { 
            background-color: var(--bg-light); 
            text-align: center; 
            margin: 0;
            padding: 20px; /* Provides breathing room on mobile */
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .success-card { 
            width: 100%;
            max-width: 500px; 
            background: white; 
            padding: 30px 20px; 
            border: 2px solid var(--brand-black); 
            box-shadow: 8px 8px 0px var(--brand-black); 
            box-sizing: border-box;
        }

        .icon-circle { 
            width: 70px; 
            height: 70px; 
            background: var(--brand-blue); 
            color: white; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 35px; 
            margin: 0 auto 20px; 
        }

        h1 { font-size: 1.5rem; margin-bottom: 10px; }
        p { font-size: 0.95rem; line-height: 1.5; color: #333; }

        .status-msg { 
            font-weight: 800; 
            color: var(--brand-blue); 
            margin-bottom: 20px; 
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 1px;
        }

        .policy-box { 
            background: #fff4f4; 
            border-left: 4px solid #d9534f; 
            padding: 15px; 
            text-align: left; 
            margin: 25px 0; 
            font-size: 0.85rem; 
        }

        .btn-primary { 
            display: block; 
            text-decoration: none; 
            background: var(--brand-black);
            color: white;
            padding: 15px;
            font-weight: bold;
            margin-top: 20px;
            border-radius: 4px;
            transition: 0.3s;
        }

        /* Desktop Adjustments */
        @media (min-width: 768px) {
            .success-card { padding: 40px; box-shadow: 10px 10px 0px var(--brand-black); }
            h1 { font-size: 2rem; }
            .icon-circle { width: 80px; height: 80px; font-size: 40px; }
        }
    </style>
</head>
<body>

    <div class="success-card">
        <div class="icon-circle">âœ“</div>
        <h1>Payment Successful!</h1>
        <p class="status-msg" id="update-status">Finalizing your booking...</p>

        <p>Thank you for choosing <strong>kitacare</strong>. Your deposit has been received.</p>

        <div class="policy-box">
            <strong>Deposit Policy:</strong><br>
            Once the booking is approved, the deposit is <strong>non-refundable</strong>. It is only refunded if cancelled by <strong>KitaCare</strong>.
        </div>

        <p style="font-size: 0.85rem; color: #666;">Our team will contact you shortly via WhatsApp or Email to confirm details.</p>

        <a href="dashboard.html" class="btn-primary">GO TO DASHBOARD</a>
    </div>

    <script src="config.js"></script>
    <script>
        async function updateStatus() {
            const userEmail = localStorage.getItem("userEmail");
            if (!userEmail) return;

            try {
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: "POST",
                    body: JSON.stringify({
                        action: "confirm_payment",
                        email: userEmail
                    })
                });
                const result = await response.json();
                if(result.status === "success") {
                    document.getElementById('update-status').innerText = "Booking Status: Paid & Confirmed";
                }
            } catch (e) {
                // If it fails, we keep the message "Finalizing..." but don't block the user.
                console.log("Status update sync in progress...");
            }
        }

        window.onload = updateStatus;
    </script>
</body>
</html>